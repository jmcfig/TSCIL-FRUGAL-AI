Namespace(agent='ER', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='LN', input_norm='IN', runs=1, epochs=20, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=0, device='cuda', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.2, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\ER_LN_Oct-14-02-27-24')

 ######## exp tasks, Run 0, cls_order :[5, 2, 1, 3, 0, 4] ########
Create exp stream : 3 tasks,  classes order [5, 2, 1, 3, 0, 4] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947
buffer has 1470 slots
ER mode: task, NCM classifier: False

--> Task 0: 2 classes in total
Epoch 1/20: Accuracy = 96.25064201335388, Loss = 0.11452019214630127
Epoch 2/20: Accuracy = 99.94863893168979, Loss = 0.002418199321255088
Epoch 3/20: Accuracy = 99.94863893168979, Loss = 0.0035355279687792063
Epoch 4/20: Accuracy = 100.0, Loss = 6.593412399524823e-05
Epoch 5/20: Accuracy = 99.69183359013869, Loss = 0.009520317427814007
Epoch 6/20: Accuracy = 100.0, Loss = 0.0003657990018837154
Epoch 7/20: Accuracy = 100.0, Loss = 2.138118816219503e-06
Epoch 8/20: Accuracy = 100.0, Loss = 2.2751401047571562e-06
Epoch 9/20: Accuracy = 100.0, Loss = 2.1530834146687994e-06
Epoch 10/20: Accuracy = 100.0, Loss = 2.0040756680828054e-06
Epoch 11/20: Accuracy = 100.0, Loss = 1.8627013105287915e-06
Epoch 12/20: Accuracy = 100.0, Loss = 1.7425065834686393e-06
Epoch 13/20: Accuracy = 100.0, Loss = 1.631830400583567e-06
Epoch 14/20: Accuracy = 100.0, Loss = 1.53671965108515e-06
Epoch 15/20: Accuracy = 100.0, Loss = 1.4540776192006888e-06
Epoch 16/20: Accuracy = 100.0, Loss = 1.4202863667378551e-06
Epoch 17/20: Accuracy = 100.0, Loss = 1.3948827017884469e-06
Epoch 18/20: Accuracy = 100.0, Loss = 1.3899317536925082e-06
Epoch 19/20: Accuracy = 100.0, Loss = 1.3898549013902084e-06
Epoch 20/20: Accuracy = 100.0, Loss = 1.3705442825084901e-06

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 1.1698172102114768e-06 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 97.70114942528735, Test CE Loss == 0.1260427087545395 ;

--> Task 1: 4 classes in total
Epoch 1/20: Accuracy = 67.8082191780822, Loss = 1.2116159200668335
Epoch 2/20: Accuracy = 93.30874604847207, Loss = 0.36987581849098206
Epoch 3/20: Accuracy = 97.78714436248683, Loss = 0.13155576586723328
Epoch 4/20: Accuracy = 97.31296101159114, Loss = 0.12564592063426971
Epoch 5/20: Accuracy = 98.63013698630137, Loss = 0.07311847805976868
Epoch 6/20: Accuracy = 99.10432033719705, Loss = 0.03907433897256851
Epoch 7/20: Accuracy = 99.73656480505795, Loss = 0.022370528429746628
Epoch 8/20: Accuracy = 99.78925184404636, Loss = 0.011913691647350788
Epoch 9/20: Accuracy = 99.73656480505795, Loss = 0.012377395294606686
Epoch 10/20: Accuracy = 99.68387776606956, Loss = 0.013121690601110458
Epoch 11/20: Accuracy = 99.73656480505795, Loss = 0.012346933595836163
Epoch 12/20: Accuracy = 99.73656480505795, Loss = 0.007936626672744751
Epoch 13/20: Accuracy = 99.94731296101159, Loss = 0.007694765459746122
Epoch 14/20: Accuracy = 99.94731296101159, Loss = 0.0036128393840044737
Epoch 15/20: Accuracy = 99.94731296101159, Loss = 0.002054759534075856
Epoch 16/20: Accuracy = 99.94731296101159, Loss = 0.0013290668139234185
Epoch 17/20: Accuracy = 100.0, Loss = 0.0002658672456163913
Epoch 18/20: Accuracy = 100.0, Loss = 0.0001758982689352706
Epoch 19/20: Accuracy = 100.0, Loss = 0.00015315353812184185
Epoch 20/20: Accuracy = 100.0, Loss = 0.00012487875937949866

 ======== Evaluate on valid set ========
Task 0: Accuracy == 95.39170506912443, Test CE Loss == 0.10574085265398026 ;
Task 1: Accuracy == 98.58490566037736, Test CE Loss == 0.050724636763334274 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 86.83385579937304, Test CE Loss == 0.8204988241195679 ;
Task 1: Accuracy == 95.01039501039502, Test CE Loss == 0.24290399253368378 ;

--> Task 2: 6 classes in total
Epoch 1/20: Accuracy = 25.581395348837212, Loss = 3.457268714904785
Epoch 2/20: Accuracy = 93.45040341718082, Loss = 0.7620722055435181
Epoch 3/20: Accuracy = 96.39297579496915, Loss = 0.20559361577033997
Epoch 4/20: Accuracy = 99.33554817275747, Loss = 0.0795724019408226
Epoch 5/20: Accuracy = 99.43046986236355, Loss = 0.04909322410821915
Epoch 6/20: Accuracy = 99.52539155196962, Loss = 0.03364616632461548
Epoch 7/20: Accuracy = 99.81015662078785, Loss = 0.021208174526691437
Epoch 8/20: Accuracy = 100.0, Loss = 0.003644140437245369
Epoch 9/20: Accuracy = 100.0, Loss = 0.0018449540948495269
Epoch 10/20: Accuracy = 100.0, Loss = 0.0007637578528374434
Epoch 11/20: Accuracy = 100.0, Loss = 0.0006339115207083523
Epoch 12/20: Accuracy = 100.0, Loss = 0.00032290228409692645
Epoch 13/20: Accuracy = 100.0, Loss = 0.00021519082656595856
Epoch 14/20: Accuracy = 100.0, Loss = 0.0001970793673535809
Epoch 15/20: Accuracy = 100.0, Loss = 0.0001633219508221373
Epoch 16/20: Accuracy = 100.0, Loss = 0.00014433384058065712
Epoch 17/20: Accuracy = 100.0, Loss = 0.00015098077710717916
Epoch 18/20: Accuracy = 100.0, Loss = 0.00014961014676373452
Epoch 19/20: Accuracy = 100.0, Loss = 0.00014554767403751612
Epoch 20/20: Accuracy = 100.0, Loss = 0.0001381235633743927

 ======== Evaluate on valid set ========
Task 0: Accuracy == 96.31336405529954, Test CE Loss == 0.08748441189527512 ;
Task 1: Accuracy == 81.60377358490565, Test CE Loss == 0.927401065826416 ;
Task 2: Accuracy == 99.57446808510639, Test CE Loss == 0.023134911432862282 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [ 95.39  98.58   0.  ]
 [ 96.31  81.6   99.57]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 90.80459770114942, Test CE Loss == 0.41059812903404236 ;
Task 1: Accuracy == 78.89812889812889, Test CE Loss == 0.8931638598442078 ;
Task 2: Accuracy == 95.52529182879378, Test CE Loss == 0.11205413937568665 ;
Accuracy matrix of all tasks:
[[97.7   0.    0.  ]
 [86.83 95.01  0.  ]
 [90.8  78.9  95.53]]

 Finish Run 0, running time 1163.1974329948425 sec
Valid Set:
 Avg_End_Acc [92.49] Avg_End_Fgt [10.34] Avg_Cur_Acc [99.38] Avg_Acc [[100.    96.98  92.49]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [88.41] Avg_End_Fgt [11.51] Avg_Cur_Acc [96.08] Avg_Acc [[97.7  90.92 88.41]] Avg_Bwtp [0.]
