Namespace(agent='ER', scenario='class', stream_split='exp', data='har', encoder='TST', head='Linear', criterion='CE', ncm_classifier=False, norm='LN', input_norm='IN', runs=1, epochs=20, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=0, device='cuda', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.05, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\TST_har\\ER_LN_Oct-08-03-55-38')

 ######## exp tasks, Run 0, cls_order :[5, 2, 1, 3, 0, 4] ########
Create exp stream : 3 tasks,  classes order [5, 2, 1, 3, 0, 4] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947
buffer has 366 slots
ER mode: task, NCM classifier: False

--> Task 0: 2 classes in total
Epoch 1/20: Accuracy = 88.34103749357986, Loss = 0.36462488770484924
Epoch 2/20: Accuracy = 97.32922444786851, Loss = 0.08310093730688095
Epoch 3/20: Accuracy = 98.15100154083206, Loss = 0.05683910474181175
Epoch 4/20: Accuracy = 99.22958397534669, Loss = 0.020606130361557007
Epoch 5/20: Accuracy = 99.17822290703646, Loss = 0.024149416014552116
Epoch 6/20: Accuracy = 99.17822290703646, Loss = 0.027930082753300667
Epoch 7/20: Accuracy = 99.84591679506933, Loss = 0.0074279652908444405
Epoch 8/20: Accuracy = 99.94863893168979, Loss = 0.0010446368250995874
Epoch 9/20: Accuracy = 100.0, Loss = 4.783226904692128e-05
Epoch 10/20: Accuracy = 100.0, Loss = 5.605173555522924e-06
Epoch 11/20: Accuracy = 100.0, Loss = 1.2185483910798212e-06
Epoch 12/20: Accuracy = 100.0, Loss = 9.895868515741313e-07
Epoch 13/20: Accuracy = 100.0, Loss = 7.242430228870944e-07
Epoch 14/20: Accuracy = 100.0, Loss = 6.108991215114656e-07
Epoch 15/20: Accuracy = 100.0, Loss = 5.237008053882164e-07
Epoch 16/20: Accuracy = 100.0, Loss = 4.6322369939844066e-07
Epoch 17/20: Accuracy = 100.0, Loss = 4.57240162177186e-07
Epoch 18/20: Accuracy = 100.0, Loss = 4.557079194000835e-07
Epoch 19/20: Accuracy = 100.0, Loss = 4.459450337890303e-07
Epoch 20/20: Accuracy = 100.0, Loss = 4.391296215544571e-07

 ======== Evaluate on valid set ========
Task 0: Accuracy == 99.53917050691244, Test CE Loss == 0.003991500940173864 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 97.07419017763846, Test CE Loss == 0.2151881456375122 ;

--> Task 1: 4 classes in total
Epoch 1/20: Accuracy = 19.704952581664912, Loss = 5.001083850860596
Epoch 2/20: Accuracy = 52.68703898840885, Loss = 2.987996816635132
Epoch 3/20: Accuracy = 69.70495258166491, Loss = 1.275733232498169
Epoch 4/20: Accuracy = 86.67017913593256, Loss = 0.6248119473457336
Epoch 5/20: Accuracy = 91.35932560590095, Loss = 0.40251070261001587
Epoch 6/20: Accuracy = 94.88935721812433, Loss = 0.23603811860084534
Epoch 7/20: Accuracy = 96.89146469968388, Loss = 0.1761900782585144
Epoch 8/20: Accuracy = 97.73445732349842, Loss = 0.11766686290502548
Epoch 9/20: Accuracy = 98.7881981032666, Loss = 0.06611518561840057
Epoch 10/20: Accuracy = 97.99789251844047, Loss = 0.087424635887146
Epoch 11/20: Accuracy = 98.73551106427819, Loss = 0.06311466544866562
Epoch 12/20: Accuracy = 99.31506849315068, Loss = 0.02611709013581276
Epoch 13/20: Accuracy = 99.05163329820864, Loss = 0.04695970192551613
Epoch 14/20: Accuracy = 99.52581664910431, Loss = 0.02179720066487789
Epoch 15/20: Accuracy = 99.68387776606956, Loss = 0.025915591046214104
Epoch 16/20: Accuracy = 99.78925184404636, Loss = 0.008622347377240658
Epoch 17/20: Accuracy = 100.0, Loss = 0.00033247939427383244
Epoch 18/20: Accuracy = 100.0, Loss = 0.00018293234461452812
Epoch 19/20: Accuracy = 100.0, Loss = 0.0001507434790255502
Epoch 20/20: Accuracy = 100.0, Loss = 0.00012973467528354377

 ======== Evaluate on valid set ========
Task 0: Accuracy == 74.19354838709677, Test CE Loss == 2.3269290924072266 ;
Task 1: Accuracy == 99.05660377358491, Test CE Loss == 0.018086766824126244 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 67.0846394984326, Test CE Loss == 3.1511893272399902 ;
Task 1: Accuracy == 93.76299376299376, Test CE Loss == 0.3297301232814789 ;

--> Task 2: 6 classes in total
Epoch 1/20: Accuracy = 0.42714760322733747, Loss = 5.547577857971191
Epoch 2/20: Accuracy = 73.32700522069293, Loss = 2.3166680335998535
Epoch 3/20: Accuracy = 92.02657807308971, Loss = 0.9451461434364319
Epoch 4/20: Accuracy = 92.406264831514, Loss = 0.5990847945213318
Epoch 5/20: Accuracy = 93.11817750355956, Loss = 0.415841668844223
Epoch 6/20: Accuracy = 96.15567157095396, Loss = 0.25330695509910583
Epoch 7/20: Accuracy = 97.24727100142383, Loss = 0.18481895327568054
Epoch 8/20: Accuracy = 97.57949691504508, Loss = 0.12223004549741745
Epoch 9/20: Accuracy = 98.43379212149976, Loss = 0.08692999184131622
Epoch 10/20: Accuracy = 98.76601803512102, Loss = 0.09682856500148773
Epoch 11/20: Accuracy = 98.43379212149976, Loss = 0.12756267189979553
Epoch 12/20: Accuracy = 98.43379212149976, Loss = 0.1047595664858818
Epoch 13/20: Accuracy = 98.8609397247271, Loss = 0.06292551755905151
Epoch 14/20: Accuracy = 99.57285239677266, Loss = 0.03497903048992157
Epoch 15/20: Accuracy = 99.2406264831514, Loss = 0.04253407567739487
Epoch 16/20: Accuracy = 99.85761746559089, Loss = 0.007167893461883068
Epoch 17/20: Accuracy = 100.0, Loss = 0.0005250230897217989
Epoch 18/20: Accuracy = 100.0, Loss = 0.0003340473340358585
Epoch 19/20: Accuracy = 100.0, Loss = 0.0002818069187924266
Epoch 20/20: Accuracy = 100.0, Loss = 0.0002503257419448346

 ======== Evaluate on valid set ========
Task 0: Accuracy == 70.50691244239631, Test CE Loss == 2.246882200241089 ;
Task 1: Accuracy == 55.660377358490564, Test CE Loss == 4.548009872436523 ;
Task 2: Accuracy == 99.14893617021276, Test CE Loss == 0.019574202597141266 ;
Accuracy matrix of all tasks:
[[99.54  0.    0.  ]
 [74.19 99.06  0.  ]
 [70.51 55.66 99.15]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 63.94984326018809, Test CE Loss == 2.999563455581665 ;
Task 1: Accuracy == 51.35135135135135, Test CE Loss == 4.2540788650512695 ;
Task 2: Accuracy == 95.23346303501945, Test CE Loss == 0.2115979939699173 ;
Accuracy matrix of all tasks:
[[97.07  0.    0.  ]
 [67.08 93.76  0.  ]
 [63.95 51.35 95.23]]

 Finish Run 0, running time 824.5478758811951 sec
Valid Set:
 Avg_End_Acc [75.11] Avg_End_Fgt [36.22] Avg_Cur_Acc [99.25] Avg_Acc [[99.54 86.62 75.11]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [70.18] Avg_End_Fgt [37.76] Avg_Cur_Acc [95.35] Avg_Acc [[97.07 80.42 70.18]] Avg_Bwtp [0.]
