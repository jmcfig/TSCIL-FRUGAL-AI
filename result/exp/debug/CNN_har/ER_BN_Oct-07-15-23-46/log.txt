Namespace(agent='ER', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='BN', input_norm='IN', runs=1, epochs=20, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=1234, device='cuda', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.0, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\ER_BN_Oct-07-15-23-46')

 ######## exp tasks, Run 0, cls_order :[2, 1, 5, 0, 4, 3] ########
Create exp stream : 3 tasks,  classes order [2, 1, 5, 0, 4, 3] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947
buffer has 0 slots
ER mode: task, NCM classifier: False

--> Task 0: 2 classes in total
Epoch 1/20: Accuracy = 96.77033492822966, Loss = 0.0969812273979187
Epoch 2/20: Accuracy = 99.9401913875598, Loss = 0.002307010116055608
Epoch 3/20: Accuracy = 100.0, Loss = 0.0005489723407663405
Epoch 4/20: Accuracy = 100.0, Loss = 0.00011654676927719265
Epoch 5/20: Accuracy = 99.82057416267942, Loss = 0.015988443046808243
Epoch 6/20: Accuracy = 100.0, Loss = 0.0004193522909190506
Epoch 7/20: Accuracy = 99.82057416267942, Loss = 0.004889610223472118
Epoch 8/20: Accuracy = 99.82057416267942, Loss = 0.003594130976125598
Epoch 9/20: Accuracy = 100.0, Loss = 0.00013673256034962833
Epoch 10/20: Accuracy = 100.0, Loss = 0.002149231731891632
Epoch 11/20: Accuracy = 100.0, Loss = 0.0008117207325994968
Epoch 12/20: Accuracy = 100.0, Loss = 0.00040732044726610184
Epoch 13/20: Accuracy = 100.0, Loss = 0.0003601392381824553
Epoch 14/20: Accuracy = 100.0, Loss = 0.0007720355642959476
Epoch 15/20: Accuracy = 100.0, Loss = 0.00018430549243930727
Epoch 16/20: Accuracy = 100.0, Loss = 1.9315239114803262e-05
Epoch 17/20: Accuracy = 100.0, Loss = 2.288517680426594e-05
Epoch 18/20: Accuracy = 100.0, Loss = 8.544048796466086e-06
Epoch 19/20: Accuracy = 100.0, Loss = 1.5327166693168692e-05
Epoch 20/20: Accuracy = 100.0, Loss = 0.0001321419549640268

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 3.5599356351667666e-07 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 97.97979797979798, Test CE Loss == 0.11300063878297806 ;

--> Task 1: 4 classes in total
Epoch 1/20: Accuracy = 35.68755846585594, Loss = nan
Epoch 2/20: Accuracy = 99.29840972871843, Loss = nan
Epoch 3/20: Accuracy = 99.9532273152479, Loss = nan
Epoch 4/20: Accuracy = 100.0, Loss = nan
Epoch 5/20: Accuracy = 100.0, Loss = nan
Epoch 6/20: Accuracy = 100.0, Loss = nan
Epoch 7/20: Accuracy = 100.0, Loss = nan
Epoch 8/20: Accuracy = 100.0, Loss = nan
Epoch 9/20: Accuracy = 100.0, Loss = nan
Epoch 10/20: Accuracy = 100.0, Loss = nan
Epoch 11/20: Accuracy = 99.76613657623948, Loss = nan
Epoch 12/20: Accuracy = 100.0, Loss = nan
Epoch 13/20: Accuracy = 99.9532273152479, Loss = nan
Epoch 14/20: Accuracy = 100.0, Loss = nan
Epoch 15/20: Accuracy = 100.0, Loss = nan
Epoch 16/20: Accuracy = 100.0, Loss = nan
Epoch 17/20: Accuracy = 100.0, Loss = nan
Epoch 18/20: Accuracy = 100.0, Loss = nan
Epoch 19/20: Accuracy = 100.0, Loss = nan
Epoch 20/20: Accuracy = 100.0, Loss = nan

 ======== Evaluate on valid set ========
Task 0: Accuracy == 0.0, Test CE Loss == 8.938949584960938 ;
Task 1: Accuracy == 100.0, Test CE Loss == 1.7530777768115513e-05 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 0.0, Test CE Loss == 8.289904594421387 ;
Task 1: Accuracy == 100.0, Test CE Loss == 0.00035554682835936546 ;

--> Task 2: 6 classes in total
Epoch 1/20: Accuracy = 0.7469654528478058, Loss = nan
Epoch 2/20: Accuracy = 70.21475256769374, Loss = nan
Epoch 3/20: Accuracy = 92.15686274509804, Loss = nan
Epoch 4/20: Accuracy = 95.37815126050421, Loss = nan
Epoch 5/20: Accuracy = 97.52567693744165, Loss = nan
Epoch 6/20: Accuracy = 98.59943977591037, Loss = nan
Epoch 7/20: Accuracy = 98.27264239028945, Loss = nan
Epoch 8/20: Accuracy = 98.73949579831933, Loss = nan
Epoch 9/20: Accuracy = 99.48646125116713, Loss = nan
Epoch 10/20: Accuracy = 99.11297852474323, Loss = nan
Epoch 11/20: Accuracy = 98.8795518207283, Loss = nan
Epoch 12/20: Accuracy = 98.97292250233427, Loss = nan
Epoch 13/20: Accuracy = 99.6265172735761, Loss = nan
Epoch 14/20: Accuracy = 99.71988795518207, Loss = nan
Epoch 15/20: Accuracy = 99.71988795518207, Loss = nan
Epoch 16/20: Accuracy = 99.20634920634922, Loss = nan
Epoch 17/20: Accuracy = 99.81325863678805, Loss = nan
Epoch 18/20: Accuracy = 99.85994397759103, Loss = nan
Epoch 19/20: Accuracy = 99.95331465919702, Loss = nan
Epoch 20/20: Accuracy = 100.0, Loss = nan

 ======== Evaluate on valid set ========
Task 0: Accuracy == 0.0, Test CE Loss == 13.671568870544434 ;
Task 1: Accuracy == 0.0, Test CE Loss == 10.509028434753418 ;
Task 2: Accuracy == 93.30543933054393, Test CE Loss == 0.18083295226097107 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [  0.   100.     0.  ]
 [  0.     0.    93.31]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 0.0, Test CE Loss == 13.126314163208008 ;
Task 1: Accuracy == 0.0, Test CE Loss == 10.67923355102539 ;
Task 2: Accuracy == 90.9090909090909, Test CE Loss == 0.2580453157424927 ;
Accuracy matrix of all tasks:
[[ 97.98   0.     0.  ]
 [  0.   100.     0.  ]
 [  0.     0.    90.91]]

 Finish Run 0, running time 1396.933866739273 sec
Valid Set:
 Avg_End_Acc [31.1] Avg_End_Fgt [100.] Avg_Cur_Acc [97.77] Avg_Acc [[100.   50.   31.1]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [30.3] Avg_End_Fgt [98.99] Avg_Cur_Acc [96.3] Avg_Acc [[97.98 50.   30.3 ]] Avg_Bwtp [0.]
