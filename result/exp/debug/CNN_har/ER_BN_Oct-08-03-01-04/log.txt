Namespace(agent='ER', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='BN', input_norm='IN', runs=1, epochs=20, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=0, device='cuda', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.05, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\ER_BN_Oct-08-03-01-04')

 ######## exp tasks, Run 0, cls_order :[5, 2, 1, 3, 0, 4] ########
Create exp stream : 3 tasks,  classes order [5, 2, 1, 3, 0, 4] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947
buffer has 366 slots
ER mode: task, NCM classifier: False

--> Task 0: 2 classes in total
Epoch 1/20: Accuracy = 97.89419619928094, Loss = 0.07540446519851685
Epoch 2/20: Accuracy = 99.94863893168979, Loss = 0.001836896175518632
Epoch 3/20: Accuracy = 100.0, Loss = 0.000562771747354418
Epoch 4/20: Accuracy = 100.0, Loss = 0.0004884132649749517
Epoch 5/20: Accuracy = 100.0, Loss = 0.00037291963235475123
Epoch 6/20: Accuracy = 100.0, Loss = 0.00012503766629379243
Epoch 7/20: Accuracy = 100.0, Loss = 0.00029991802875883877
Epoch 8/20: Accuracy = 100.0, Loss = 7.352115790126845e-05
Epoch 9/20: Accuracy = 100.0, Loss = 0.00010700560233090073
Epoch 10/20: Accuracy = 100.0, Loss = 1.9438852177700028e-05
Epoch 11/20: Accuracy = 100.0, Loss = 0.00014697440201416612
Epoch 12/20: Accuracy = 100.0, Loss = 0.00020581141870934516
Epoch 13/20: Accuracy = 99.84591679506933, Loss = 0.0033200911711901426
Epoch 14/20: Accuracy = 99.84591679506933, Loss = 0.0025588632561266422
Epoch 15/20: Accuracy = 99.69183359013869, Loss = 0.007080366834998131
Epoch 16/20: Accuracy = 99.94863893168979, Loss = 0.0008205640478990972
Epoch 17/20: Accuracy = 100.0, Loss = 0.00047298040590249
Epoch 18/20: Accuracy = 100.0, Loss = 5.2955758292227983e-05
Epoch 19/20: Accuracy = 100.0, Loss = 4.4760541641153395e-05
Epoch 20/20: Accuracy = 100.0, Loss = 0.00010798648145282641

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 6.405347221516422e-07 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 99.37304075235109, Test CE Loss == 0.009270114824175835 ;

--> Task 1: 4 classes in total
Epoch 1/20: Accuracy = 18.86195995785037, Loss = 4.077455520629883
Epoch 2/20: Accuracy = 97.99789251844047, Loss = 0.4988866150379181
Epoch 3/20: Accuracy = 99.94731296101159, Loss = 0.008352852426469326
Epoch 4/20: Accuracy = 100.0, Loss = 0.0024486719630658627
Epoch 5/20: Accuracy = 100.0, Loss = 0.0014736626762896776
Epoch 6/20: Accuracy = 100.0, Loss = 0.0010748520726338029
Epoch 7/20: Accuracy = 100.0, Loss = 0.0007795915007591248
Epoch 8/20: Accuracy = 100.0, Loss = 0.0006903975736349821
Epoch 9/20: Accuracy = 100.0, Loss = 0.0010948529234156013
Epoch 10/20: Accuracy = 100.0, Loss = 0.0014556291280314326
Epoch 11/20: Accuracy = 99.94731296101159, Loss = 0.0021864131558686495
Epoch 12/20: Accuracy = 100.0, Loss = 0.0015647327527403831
Epoch 13/20: Accuracy = 100.0, Loss = 0.00040975844603963196
Epoch 14/20: Accuracy = 100.0, Loss = 0.00031549864797852933
Epoch 15/20: Accuracy = 100.0, Loss = 0.0002214022388216108
Epoch 16/20: Accuracy = 100.0, Loss = 0.00023332757700700313
Epoch 17/20: Accuracy = 100.0, Loss = 0.00022323748271446675
Epoch 18/20: Accuracy = 100.0, Loss = 0.00021493823442142457
Epoch 19/20: Accuracy = 100.0, Loss = 0.00047130801249295473
Epoch 20/20: Accuracy = 100.0, Loss = 0.0002534581581130624

 ======== Evaluate on valid set ========
Task 0: Accuracy == 45.16129032258064, Test CE Loss == 1.3629916906356812 ;
Task 1: Accuracy == 96.69811320754717, Test CE Loss == 0.11525863409042358 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 47.02194357366771, Test CE Loss == 1.333173394203186 ;
Task 1: Accuracy == 94.8024948024948, Test CE Loss == 0.14883466064929962 ;

--> Task 2: 6 classes in total
Epoch 1/20: Accuracy = 0.47460844803037494, Loss = 6.48000955581665
Epoch 2/20: Accuracy = 87.4703369719981, Loss = 0.8204107284545898
Epoch 3/20: Accuracy = 99.81015662078785, Loss = 0.03178992494940758
Epoch 4/20: Accuracy = 100.0, Loss = 0.008702326565980911
Epoch 5/20: Accuracy = 100.0, Loss = 0.0035111953038722277
Epoch 6/20: Accuracy = 100.0, Loss = 0.002940601436421275
Epoch 7/20: Accuracy = 100.0, Loss = 0.001993652433156967
Epoch 8/20: Accuracy = 100.0, Loss = 0.001535779912956059
Epoch 9/20: Accuracy = 100.0, Loss = 0.000953029200900346
Epoch 10/20: Accuracy = 100.0, Loss = 0.0006518720765598118
Epoch 11/20: Accuracy = 100.0, Loss = 0.0004399465979076922
Epoch 12/20: Accuracy = 100.0, Loss = 0.00035906824632547796
Epoch 13/20: Accuracy = 99.90507831039392, Loss = 0.0021250308491289616
Epoch 14/20: Accuracy = 100.0, Loss = 0.0018823865102604032
Epoch 15/20: Accuracy = 100.0, Loss = 0.001006591715849936
Epoch 16/20: Accuracy = 100.0, Loss = 0.0007832765113562346
Epoch 17/20: Accuracy = 100.0, Loss = 0.0004956917837262154
Epoch 18/20: Accuracy = 100.0, Loss = 0.0003513188275974244
Epoch 19/20: Accuracy = 100.0, Loss = 0.000995990470983088
Epoch 20/20: Accuracy = 100.0, Loss = 0.0005715822917409241

 ======== Evaluate on valid set ========
Task 0: Accuracy == 79.72350230414746, Test CE Loss == 0.6781359314918518 ;
Task 1: Accuracy == 50.0, Test CE Loss == 1.8136379718780518 ;
Task 2: Accuracy == 98.72340425531915, Test CE Loss == 0.05617426708340645 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [ 45.16  96.7    0.  ]
 [ 79.72  50.    98.72]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 70.9508881922675, Test CE Loss == 0.9707651734352112 ;
Task 1: Accuracy == 51.24740124740125, Test CE Loss == 1.713323712348938 ;
Task 2: Accuracy == 97.37354085603113, Test CE Loss == 0.09021350741386414 ;
Accuracy matrix of all tasks:
[[99.37  0.    0.  ]
 [47.02 94.8   0.  ]
 [70.95 51.25 97.37]]

 Finish Run 0, running time 1218.5816495418549 sec
Valid Set:
 Avg_End_Acc [76.15] Avg_End_Fgt [33.49] Avg_Cur_Acc [98.47] Avg_Acc [[100.    70.93  76.15]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [73.19] Avg_End_Fgt [35.98] Avg_Cur_Acc [97.18] Avg_Acc [[99.37 70.91 73.19]] Avg_Bwtp [0.]
