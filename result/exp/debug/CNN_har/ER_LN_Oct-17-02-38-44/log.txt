Namespace(agent='ER', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='LN', input_norm='IN', runs=1, epochs=50, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=0, device='cuda', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.4, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\ER_LN_Oct-17-02-38-44')

 ######## exp tasks, Run 0, cls_order :[5, 2, 1, 3, 0, 4] ########
Create exp stream : 3 tasks,  classes order [5, 2, 1, 3, 0, 4] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947
buffer has 2940 slots
ER mode: task, NCM classifier: False

--> Task 0: 2 classes in total
Epoch 1/50: Accuracy = 96.25064201335388, Loss = 0.11452019214630127
Epoch 2/50: Accuracy = 99.94863893168979, Loss = 0.002418199321255088
Epoch 3/50: Accuracy = 99.94863893168979, Loss = 0.0035355279687792063
Epoch 4/50: Accuracy = 100.0, Loss = 6.593412399524823e-05
Epoch 5/50: Accuracy = 99.69183359013869, Loss = 0.009520317427814007
Epoch 6/50: Accuracy = 100.0, Loss = 0.0003657990018837154
Epoch 7/50: Accuracy = 100.0, Loss = 2.138118816219503e-06
Epoch 8/50: Accuracy = 100.0, Loss = 2.2751401047571562e-06
Epoch 9/50: Accuracy = 100.0, Loss = 2.1530834146687994e-06
Epoch 10/50: Accuracy = 100.0, Loss = 2.0040756680828054e-06
Epoch 11/50: Accuracy = 100.0, Loss = 1.8627013105287915e-06
Epoch 12/50: Accuracy = 100.0, Loss = 1.7425065834686393e-06
Epoch 13/50: Accuracy = 100.0, Loss = 1.631830400583567e-06
Epoch 14/50: Accuracy = 100.0, Loss = 1.53671965108515e-06
Epoch 15/50: Accuracy = 100.0, Loss = 1.4540776192006888e-06
Epoch 16/50: Accuracy = 100.0, Loss = 1.4202863667378551e-06
Epoch 17/50: Accuracy = 100.0, Loss = 1.3948827017884469e-06
Epoch 18/50: Accuracy = 100.0, Loss = 1.3899317536925082e-06
Epoch 19/50: Accuracy = 100.0, Loss = 1.3898549013902084e-06
Epoch 20/50: Accuracy = 100.0, Loss = 1.3705442825084901e-06
Epoch 21/50: Accuracy = 100.0, Loss = 1.359957082058827e-06
Epoch 22/50: Accuracy = 100.0, Loss = 1.3518872492568335e-06
Early stopping

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 1.1698172102114768e-06 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 97.70114942528735, Test CE Loss == 0.1260427087545395 ;

--> Task 1: 4 classes in total
Epoch 1/50: Accuracy = 71.75974710221286, Loss = 1.2329890727996826
Epoch 2/50: Accuracy = 92.20231822971549, Loss = 0.3563110828399658
Epoch 3/50: Accuracy = 97.6290832455216, Loss = 0.14089922606945038
Epoch 4/50: Accuracy = 97.99789251844047, Loss = 0.10040000081062317
Epoch 5/50: Accuracy = 98.47207586933614, Loss = 0.08206410706043243
Epoch 6/50: Accuracy = 99.15700737618546, Loss = 0.047098308801651
Epoch 7/50: Accuracy = 99.52581664910431, Loss = 0.0222836434841156
Epoch 8/50: Accuracy = 99.78925184404636, Loss = 0.015668421983718872
Epoch 9/50: Accuracy = 99.57850368809274, Loss = 0.03230004757642746
Epoch 10/50: Accuracy = 99.57850368809274, Loss = 0.01550611574202776
Epoch 11/50: Accuracy = 99.94731296101159, Loss = 0.014689046889543533
Epoch 12/50: Accuracy = 99.94731296101159, Loss = 0.003820913378149271
Epoch 13/50: Accuracy = 100.0, Loss = 0.0008520850096829236
Epoch 14/50: Accuracy = 100.0, Loss = 0.00017571248463355005
Epoch 15/50: Accuracy = 100.0, Loss = 7.762134191580117e-05
Epoch 16/50: Accuracy = 100.0, Loss = 7.391113467747346e-05
Epoch 17/50: Accuracy = 100.0, Loss = 6.868030322948471e-05
Epoch 18/50: Accuracy = 100.0, Loss = 6.276220665313303e-05
Epoch 19/50: Accuracy = 100.0, Loss = 6.167345418361947e-05
Epoch 20/50: Accuracy = 100.0, Loss = 5.946269811829552e-05
Epoch 21/50: Accuracy = 100.0, Loss = 6.403657607734203e-05
Epoch 22/50: Accuracy = 100.0, Loss = 6.780360854463652e-05
Epoch 23/50: Accuracy = 100.0, Loss = 6.408242916222662e-05
Early stopping

 ======== Evaluate on valid set ========
Task 0: Accuracy == 95.85253456221197, Test CE Loss == 0.12270603328943253 ;
Task 1: Accuracy == 98.11320754716981, Test CE Loss == 0.05363156646490097 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 88.19226750261234, Test CE Loss == 0.4495837092399597 ;
Task 1: Accuracy == 93.24324324324324, Test CE Loss == 0.2677442133426666 ;

--> Task 2: 6 classes in total
Epoch 1/50: Accuracy = 44.28096820123398, Loss = 2.653008460998535
Epoch 2/50: Accuracy = 92.02657807308971, Loss = 0.6371833086013794
Epoch 3/50: Accuracy = 96.67774086378738, Loss = 0.2541683316230774
Epoch 4/50: Accuracy = 97.86426198386332, Loss = 0.17033343017101288
Epoch 5/50: Accuracy = 98.718557190318, Loss = 0.1108393743634224
Epoch 6/50: Accuracy = 98.95586141433319, Loss = 0.08535604178905487
Epoch 7/50: Accuracy = 99.47793070716658, Loss = 0.048027403652668
Epoch 8/50: Accuracy = 99.38300901756051, Loss = 0.06249794363975525
Epoch 9/50: Accuracy = 99.47793070716658, Loss = 0.03632889688014984
Epoch 10/50: Accuracy = 99.81015662078785, Loss = 0.028136758133769035
Epoch 11/50: Accuracy = 99.43046986236355, Loss = 0.050438717007637024
Epoch 12/50: Accuracy = 99.81015662078785, Loss = 0.021600158885121346
Epoch 13/50: Accuracy = 99.66777408637874, Loss = 0.048946280032396317
Epoch 14/50: Accuracy = 99.2406264831514, Loss = 0.04905583709478378
Epoch 15/50: Accuracy = 99.95253915519696, Loss = 0.015222000889480114
Epoch 16/50: Accuracy = 99.95253915519696, Loss = 0.0029928898438811302
Epoch 17/50: Accuracy = 100.0, Loss = 0.0025126757100224495
Epoch 18/50: Accuracy = 100.0, Loss = 0.0014906189171597362
Epoch 19/50: Accuracy = 100.0, Loss = 0.0008547053439542651
Epoch 20/50: Accuracy = 100.0, Loss = 0.0008936034864746034
Epoch 21/50: Accuracy = 100.0, Loss = 0.00069014000473544
Epoch 22/50: Accuracy = 100.0, Loss = 0.0006904618348926306
Epoch 23/50: Accuracy = 100.0, Loss = 0.0006341816624626517
Epoch 24/50: Accuracy = 100.0, Loss = 0.0005096932291053236
Early stopping

 ======== Evaluate on valid set ========
Task 0: Accuracy == 95.85253456221197, Test CE Loss == 0.1157488226890564 ;
Task 1: Accuracy == 83.49056603773585, Test CE Loss == 0.7054365873336792 ;
Task 2: Accuracy == 100.0, Test CE Loss == 0.011364756152033806 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [ 95.85  98.11   0.  ]
 [ 95.85  83.49 100.  ]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 89.86415882967607, Test CE Loss == 0.33004432916641235 ;
Task 1: Accuracy == 81.6008316008316, Test CE Loss == 0.5683038830757141 ;
Task 2: Accuracy == 96.10894941634241, Test CE Loss == 0.15350264310836792 ;
Accuracy matrix of all tasks:
[[97.7   0.    0.  ]
 [88.19 93.24  0.  ]
 [89.86 81.6  96.11]]

 Finish Run 0, running time 1185.1213684082031 sec
Valid Set:
 Avg_End_Acc [93.11] Avg_End_Fgt [9.39] Avg_Cur_Acc [99.37] Avg_Acc [[100.    96.98  93.11]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [89.19] Avg_End_Fgt [9.74] Avg_Cur_Acc [95.68] Avg_Acc [[97.7  90.72 89.19]] Avg_Bwtp [0.]
