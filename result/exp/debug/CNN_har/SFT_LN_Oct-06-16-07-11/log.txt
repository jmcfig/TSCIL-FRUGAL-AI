Namespace(agent='SFT', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='LN', input_norm='IN', runs=1, epochs=20, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=1234, device='cuda', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.05, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\SFT_LN_Oct-06-16-07-11')

 ######## exp tasks, Run 0, cls_order :[2, 1, 5, 0, 4, 3] ########
Create exp stream : 3 tasks,  classes order [2, 1, 5, 0, 4, 3] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947

--> Task 0: 2 classes in total
Epoch 1/20: Accuracy = 0.11961299180984497, Loss = 95.75358851674642
Epoch 2/20: Accuracy = 0.0003106672957073897, Loss = 100.0
Epoch 3/20: Accuracy = 8.093925134744495e-05, Loss = 100.0
Epoch 4/20: Accuracy = 3.684754847199656e-05, Loss = 100.0
Epoch 5/20: Accuracy = 3.828757144219708e-06, Loss = 100.0
Epoch 6/20: Accuracy = 8.331008416462282e-07, Loss = 100.0
Epoch 7/20: Accuracy = 6.217570671651629e-07, Loss = 100.0
Epoch 8/20: Accuracy = 5.807828529214021e-07, Loss = 100.0
Epoch 9/20: Accuracy = 4.993912057216221e-07, Loss = 100.0
Epoch 10/20: Accuracy = 4.6206940851334366e-07, Loss = 100.0
Epoch 11/20: Accuracy = 4.2840224523388315e-07, Loss = 100.0
Epoch 12/20: Accuracy = 4.026774718113302e-07, Loss = 100.0
Epoch 13/20: Accuracy = 3.766716076825105e-07, Loss = 100.0
Epoch 14/20: Accuracy = 3.578347786969971e-07, Loss = 100.0
Epoch 15/20: Accuracy = 3.41176729534709e-07, Loss = 100.0
Epoch 16/20: Accuracy = 3.2592456022939587e-07, Loss = 100.0
Epoch 17/20: Accuracy = 3.2416738804386114e-07, Loss = 100.0
Epoch 18/20: Accuracy = 3.2226964208348363e-07, Loss = 100.0
Epoch 19/20: Accuracy = 3.2079361744763446e-07, Loss = 100.0
Epoch 20/20: Accuracy = 3.1987985948944697e-07, Loss = 100.0

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 1.3084486738534906e-07 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 98.76543209876543, Test CE Loss == 0.03138412535190582 ;

--> Task 1: 4 classes in total
Epoch 1/20: Accuracy = 0.5230275988578796, Loss = 83.06828811973807
Epoch 2/20: Accuracy = 0.0023879357613623142, Loss = 99.9532273152479
Epoch 3/20: Accuracy = 4.822535265702754e-05, Loss = 100.0
Epoch 4/20: Accuracy = 1.7958811440621503e-05, Loss = 100.0
Epoch 5/20: Accuracy = 1.3613698683911934e-05, Loss = 100.0
Epoch 6/20: Accuracy = 1.1451128557382617e-05, Loss = 100.0
Epoch 7/20: Accuracy = 9.869039786281064e-06, Loss = 100.0
Epoch 8/20: Accuracy = 8.669527232996188e-06, Loss = 100.0
Epoch 9/20: Accuracy = 7.686607204959728e-06, Loss = 100.0
Epoch 10/20: Accuracy = 6.908490377099952e-06, Loss = 100.0
Epoch 11/20: Accuracy = 6.244340056582587e-06, Loss = 100.0
Epoch 12/20: Accuracy = 5.706629053747747e-06, Loss = 100.0
Epoch 13/20: Accuracy = 5.221564151725033e-06, Loss = 100.0
Epoch 14/20: Accuracy = 4.813804935110966e-06, Loss = 100.0
Epoch 15/20: Accuracy = 4.4555140448210295e-06, Loss = 100.0
Epoch 16/20: Accuracy = 4.25373491452774e-06, Loss = 100.0
Epoch 17/20: Accuracy = 4.226960754749598e-06, Loss = 100.0
Epoch 18/20: Accuracy = 4.198545866529457e-06, Loss = 100.0
Epoch 19/20: Accuracy = 4.178287781542167e-06, Loss = 100.0
Epoch 20/20: Accuracy = 4.128305135964183e-06, Loss = 100.0

 ======== Evaluate on valid set ========
Task 0: Accuracy == 0.0, Test CE Loss == 11.95081615447998 ;
Task 1: Accuracy == 100.0, Test CE Loss == 4.420032837515464e-06 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 0.0, Test CE Loss == 11.718965530395508 ;
Task 1: Accuracy == 97.48305905130688, Test CE Loss == 0.109516441822052 ;

--> Task 2: 6 classes in total
Epoch 1/20: Accuracy = 3.717580795288086, Loss = 20.49486461251167
Epoch 2/20: Accuracy = 0.476433128118515, Loss = 76.98412698412699
Epoch 3/20: Accuracy = 0.27972641587257385, Loss = 88.42203548085901
Epoch 4/20: Accuracy = 0.23953679203987122, Loss = 90.61624649859944
Epoch 5/20: Accuracy = 0.1280404031276703, Loss = 94.9579831932773
Epoch 6/20: Accuracy = 0.10446982830762863, Loss = 95.23809523809523
Epoch 7/20: Accuracy = 0.042635347694158554, Loss = 98.45938375350141
Epoch 8/20: Accuracy = 0.024384094402194023, Loss = 98.97292250233427
Epoch 9/20: Accuracy = 0.012467416003346443, Loss = 99.67320261437908
Epoch 10/20: Accuracy = 0.01830156147480011, Loss = 99.20634920634922
Epoch 11/20: Accuracy = 0.01995936967432499, Loss = 99.20634920634922
Epoch 12/20: Accuracy = 0.004398411605507135, Loss = 99.90662931839402
Epoch 13/20: Accuracy = 0.005028475541621447, Loss = 99.85994397759103
Epoch 14/20: Accuracy = 0.006937731057405472, Loss = 99.71988795518207
Epoch 15/20: Accuracy = 0.009064826183021069, Loss = 99.71988795518207
Epoch 16/20: Accuracy = 0.00233992887660861, Loss = 99.95331465919702
Epoch 17/20: Accuracy = 0.0004530029254965484, Loss = 100.0
Epoch 18/20: Accuracy = 0.000335525517584756, Loss = 100.0
Epoch 19/20: Accuracy = 0.0002756927569862455, Loss = 100.0
Epoch 20/20: Accuracy = 0.0002487479359842837, Loss = 100.0

 ======== Evaluate on valid set ========
Task 0: Accuracy == 0.0, Test CE Loss == 16.84271240234375 ;
Task 1: Accuracy == 0.0, Test CE Loss == 12.379814147949219 ;
Task 2: Accuracy == 91.63179916317992, Test CE Loss == 0.21170589327812195 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [  0.   100.     0.  ]
 [  0.     0.    91.63]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 0.0, Test CE Loss == 16.47492027282715 ;
Task 1: Accuracy == 0.0, Test CE Loss == 12.25088882446289 ;
Task 2: Accuracy == 92.27761485826001, Test CE Loss == 0.2457723617553711 ;
Accuracy matrix of all tasks:
[[98.77  0.    0.  ]
 [ 0.   97.48  0.  ]
 [ 0.    0.   92.28]]

 Finish Run 0, running time 734.7106122970581 sec
Valid Set:
 Avg_End_Acc [30.54] Avg_End_Fgt [100.] Avg_Cur_Acc [97.21] Avg_Acc [[100.    50.    30.54]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [30.76] Avg_End_Fgt [98.12] Avg_Cur_Acc [96.18] Avg_Acc [[98.77 48.74 30.76]] Avg_Bwtp [0.]
