Namespace(agent='ER', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='LN', input_norm='IN', runs=1, epochs=20, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=1234, device='cpu', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.05, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\ER_LN_Oct-06-15-09-54')

 ######## exp tasks, Run 0, cls_order :[2, 1, 5, 0, 4, 3] ########
Create exp stream : 3 tasks,  classes order [2, 1, 5, 0, 4, 3] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947
buffer has 366 slots
ER mode: task, NCM classifier: False

--> Task 0: 2 classes in total
Epoch 1/20: Accuracy = 95.75358851674642, Loss = 0.11961332708597183
Epoch 2/20: Accuracy = 100.0, Loss = 0.0003242317761760205
Epoch 3/20: Accuracy = 99.82057416267942, Loss = 0.008811778388917446
Epoch 4/20: Accuracy = 99.28229665071771, Loss = 0.023285148665308952
Epoch 5/20: Accuracy = 100.0, Loss = 0.00013541721273213625
Epoch 6/20: Accuracy = 100.0, Loss = 4.1841478378046304e-05
Epoch 7/20: Accuracy = 100.0, Loss = 9.337351002614014e-06
Epoch 8/20: Accuracy = 100.0, Loss = 6.323580237221904e-06
Epoch 9/20: Accuracy = 100.0, Loss = 4.712020199804101e-06
Epoch 10/20: Accuracy = 100.0, Loss = 4.367634574009571e-06
Epoch 11/20: Accuracy = 100.0, Loss = 3.5081993701169267e-06
Epoch 12/20: Accuracy = 100.0, Loss = 3.1263800792658003e-06
Epoch 13/20: Accuracy = 100.0, Loss = 2.807277951433207e-06
Epoch 14/20: Accuracy = 100.0, Loss = 2.6097502541233553e-06
Epoch 15/20: Accuracy = 100.0, Loss = 2.332643134650425e-06
Epoch 16/20: Accuracy = 100.0, Loss = 2.209516196671757e-06
Epoch 17/20: Accuracy = 100.0, Loss = 2.189627593907062e-06
Epoch 18/20: Accuracy = 100.0, Loss = 2.171214873669669e-06
Epoch 19/20: Accuracy = 100.0, Loss = 2.14872579817893e-06
Epoch 20/20: Accuracy = 100.0, Loss = 2.1575142454821616e-06

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 7.326511877181474e-07 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 99.10213243546578, Test CE Loss == 0.034996289759874344 ;

--> Task 1: 4 classes in total
Epoch 1/20: Accuracy = 68.98971000935454, Loss = 1.1156085729599
Epoch 2/20: Accuracy = 99.29840972871843, Loss = 0.034396830946207047
Epoch 3/20: Accuracy = 99.9532273152479, Loss = 0.001966767944395542
Epoch 4/20: Accuracy = 100.0, Loss = 0.00028722514980472624
Epoch 5/20: Accuracy = 100.0, Loss = 8.655670535517856e-05
Epoch 6/20: Accuracy = 100.0, Loss = 6.336972728604451e-05
Epoch 7/20: Accuracy = 100.0, Loss = 5.345098543330096e-05
Epoch 8/20: Accuracy = 100.0, Loss = 4.302609886508435e-05
Epoch 9/20: Accuracy = 100.0, Loss = 3.9327554986812174e-05
Epoch 10/20: Accuracy = 100.0, Loss = 3.4937242162413895e-05
Epoch 11/20: Accuracy = 100.0, Loss = 3.125933653791435e-05
Epoch 12/20: Accuracy = 100.0, Loss = 2.820364898070693e-05
Epoch 13/20: Accuracy = 100.0, Loss = 2.447473889333196e-05
Epoch 14/20: Accuracy = 100.0, Loss = 2.262513226014562e-05
Epoch 15/20: Accuracy = 100.0, Loss = 2.0898554794257507e-05
Epoch 16/20: Accuracy = 100.0, Loss = 1.971998244698625e-05
Epoch 17/20: Accuracy = 100.0, Loss = 1.8745127817965113e-05
Epoch 18/20: Accuracy = 100.0, Loss = 1.940846414072439e-05
Epoch 19/20: Accuracy = 100.0, Loss = 1.909340608108323e-05
Epoch 20/20: Accuracy = 100.0, Loss = 1.870884261734318e-05

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 1.5875461031100713e-05 ;
Task 1: Accuracy == 100.0, Test CE Loss == 3.928698060917668e-05 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 95.51066217732884, Test CE Loss == 0.21744610369205475 ;
Task 1: Accuracy == 97.38625363020329, Test CE Loss == 0.11399872601032257 ;

--> Task 2: 6 classes in total
Epoch 1/20: Accuracy = 19.934640522875817, Loss = 4.094770908355713
Epoch 2/20: Accuracy = 73.01587301587301, Loss = 0.8930045366287231
Epoch 3/20: Accuracy = 89.2156862745098, Loss = 0.2993704676628113
Epoch 4/20: Accuracy = 94.07096171802054, Loss = 0.1587802916765213
Epoch 5/20: Accuracy = 96.77871148459384, Loss = 0.0914149284362793
Epoch 6/20: Accuracy = 98.78618113912232, Loss = 0.042390890419483185
Epoch 7/20: Accuracy = 98.59943977591037, Loss = 0.0418815016746521
Epoch 8/20: Accuracy = 99.53314659197012, Loss = 0.015686755999922752
Epoch 9/20: Accuracy = 99.71988795518207, Loss = 0.010350595228374004
Epoch 10/20: Accuracy = 99.85994397759103, Loss = 0.005986599251627922
Epoch 11/20: Accuracy = 100.0, Loss = 0.0036827768199145794
Epoch 12/20: Accuracy = 99.90662931839402, Loss = 0.002650211565196514
Epoch 13/20: Accuracy = 100.0, Loss = 0.0009371982887387276
Epoch 14/20: Accuracy = 100.0, Loss = 0.00030008816975168884
Epoch 15/20: Accuracy = 100.0, Loss = 0.00020643655443564057
Epoch 16/20: Accuracy = 100.0, Loss = 0.00018377247033640742
Epoch 17/20: Accuracy = 100.0, Loss = 0.00018039818678516895
Epoch 18/20: Accuracy = 100.0, Loss = 0.00017521063273306936
Epoch 19/20: Accuracy = 100.0, Loss = 0.0001741308660712093
Epoch 20/20: Accuracy = 100.0, Loss = 0.0001669426419539377

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 0.0040946416556835175 ;
Task 1: Accuracy == 76.47058823529412, Test CE Loss == 1.1001492738723755 ;
Task 2: Accuracy == 94.14225941422593, Test CE Loss == 0.21722635626792908 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [100.   100.     0.  ]
 [100.    76.47  94.14]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 93.15375982042649, Test CE Loss == 0.29270005226135254 ;
Task 1: Accuracy == 68.34462729912875, Test CE Loss == 2.1720616817474365 ;
Task 2: Accuracy == 92.27761485826001, Test CE Loss == 0.26115143299102783 ;
Accuracy matrix of all tasks:
[[99.1   0.    0.  ]
 [95.51 97.39  0.  ]
 [93.15 68.34 92.28]]

 Finish Run 0, running time 181.78760433197021 sec
Valid Set:
 Avg_End_Acc [90.2] Avg_End_Fgt [11.76] Avg_Cur_Acc [98.05] Avg_Acc [[100.  100.   90.2]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [84.59] Avg_End_Fgt [17.5] Avg_Cur_Acc [96.26] Avg_Acc [[99.1  96.45 84.59]] Avg_Bwtp [0.]
