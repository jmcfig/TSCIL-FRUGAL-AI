Namespace(agent='SFT', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='LN', input_norm='IN', runs=1, epochs=10, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=1234, device='cpu', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.05, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\SFT_LN_Oct-06-15-27-07')

 ######## exp tasks, Run 0, cls_order :[2, 1, 5, 0, 4, 3] ########
Create exp stream : 3 tasks,  classes order [2, 1, 5, 0, 4, 3] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947

--> Task 0: 2 classes in total
Epoch 1/10: Accuracy = 0.11961332708597183, Loss = 95.75358851674642
Epoch 2/10: Accuracy = 0.0003242317761760205, Loss = 100.0
Epoch 3/10: Accuracy = 0.008811778388917446, Loss = 99.82057416267942
Epoch 4/10: Accuracy = 0.023285148665308952, Loss = 99.28229665071771
Epoch 5/10: Accuracy = 0.00013541721273213625, Loss = 100.0
Epoch 6/10: Accuracy = 4.1841478378046304e-05, Loss = 100.0
Epoch 7/10: Accuracy = 9.337351002614014e-06, Loss = 100.0
Epoch 8/10: Accuracy = 6.323580237221904e-06, Loss = 100.0
Epoch 9/10: Accuracy = 4.712020199804101e-06, Loss = 100.0
Epoch 10/10: Accuracy = 4.367634574009571e-06, Loss = 100.0

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 1.1114453855043394e-06 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 99.10213243546578, Test CE Loss == 0.037125714123249054 ;

--> Task 1: 4 classes in total
Epoch 1/10: Accuracy = 0.8968859314918518, Loss = 73.90084190832555
Epoch 2/10: Accuracy = 0.0034864319022744894, Loss = 99.9532273152479
Epoch 3/10: Accuracy = 2.1135079805389978e-05, Loss = 100.0
Epoch 4/10: Accuracy = 1.610417712072376e-05, Loss = 100.0
Epoch 5/10: Accuracy = 1.3050002962700091e-05, Loss = 100.0
Epoch 6/10: Accuracy = 1.1147708391945343e-05, Loss = 100.0
Epoch 7/10: Accuracy = 9.699794645712245e-06, Loss = 100.0
Epoch 8/10: Accuracy = 8.558119588997215e-06, Loss = 100.0
Epoch 9/10: Accuracy = 7.660463779757265e-06, Loss = 100.0
Epoch 10/10: Accuracy = 6.895972092024749e-06, Loss = 100.0

 ======== Evaluate on valid set ========
Task 0: Accuracy == 0.0, Test CE Loss == 13.32677173614502 ;
Task 1: Accuracy == 100.0, Test CE Loss == 6.020985438226489e-06 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 0.0, Test CE Loss == 12.900988578796387 ;
Task 1: Accuracy == 97.38625363020329, Test CE Loss == 0.0957477018237114 ;

--> Task 2: 6 classes in total
Epoch 1/10: Accuracy = 4.650595664978027, Loss = 11.718020541549953
Epoch 2/10: Accuracy = 0.5036924481391907, Loss = 74.97665732959851
Epoch 3/10: Accuracy = 0.2600092589855194, Loss = 89.30905695611578
Epoch 4/10: Accuracy = 0.16268892586231232, Loss = 93.93090569561157
Epoch 5/10: Accuracy = 0.10700058937072754, Loss = 95.98506069094304
Epoch 6/10: Accuracy = 0.0816592127084732, Loss = 96.73202614379085
Epoch 7/10: Accuracy = 0.03740013390779495, Loss = 98.69281045751634
Epoch 8/10: Accuracy = 0.03109225258231163, Loss = 98.97292250233427
Epoch 9/10: Accuracy = 0.03681306168437004, Loss = 98.64612511671336
Epoch 10/10: Accuracy = 0.0527680478990078, Loss = 98.0392156862745

 ======== Evaluate on valid set ========
Task 0: Accuracy == 0.0, Test CE Loss == 14.189595222473145 ;
Task 1: Accuracy == 0.0, Test CE Loss == 13.83614730834961 ;
Task 2: Accuracy == 93.72384937238493, Test CE Loss == 0.19787506759166718 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [  0.   100.     0.  ]
 [  0.     0.    93.72]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 0.0, Test CE Loss == 13.77413272857666 ;
Task 1: Accuracy == 0.0, Test CE Loss == 13.905739784240723 ;
Task 2: Accuracy == 92.08211143695014, Test CE Loss == 0.24646805226802826 ;
Accuracy matrix of all tasks:
[[99.1   0.    0.  ]
 [ 0.   97.39  0.  ]
 [ 0.    0.   92.08]]

 Finish Run 0, running time 58.04810547828674 sec
Valid Set:
 Avg_End_Acc [31.24] Avg_End_Fgt [100.] Avg_Cur_Acc [97.91] Avg_Acc [[100.    50.    31.24]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [30.69] Avg_End_Fgt [98.24] Avg_Cur_Acc [96.19] Avg_Acc [[99.1  48.7  30.69]] Avg_Bwtp [0.]
