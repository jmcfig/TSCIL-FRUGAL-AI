Namespace(agent='ER', scenario='class', stream_split='exp', data='har', encoder='CNN', head='Linear', criterion='CE', ncm_classifier=False, norm='LN', input_norm='IN', runs=1, epochs=20, batch_size=32, lr=0.001, lradj='step15', early_stop=True, patience=20, weight_decay=0, dropout=0, feature_dim=128, n_layers=4, tune=False, debug=True, seed=0, device='cuda', verbose=True, exp_start_time=None, fix_order=False, cf_matrix=True, tsne=False, tsne_g=True, er_mode='task', mem_budget=0.4, buffer_tracker=False, der_plus=False, er_sub_type='part', teacher_eval=False, lambda_kd_lwf=1, lambda_kd_fmap=0.01, fmap_kd_metric='dtw', lambda_protoAug=100, adaptive_weight=False, lambda_impt=10000, ewc_mode='separate', aser_k=3, aser_type='asvm', aser_n_smp_cls=4, mc_retrieve=False, beta_lr=0.0001, lambda_beta=1, epochs_g=500, lr_g=0.001, recon_wt=0.1, mnemonics_epochs=1, mnemonics_lr=1e-05, start_noise=True, save_mode=0, n_samples_to_plot=5, augment_batch=False, visual_syn_feat=True, iterations_per_layer=100, inversion_lr=0.01, inchannel_scale=10, xchannel_scale=1, feat_scale=1, k_freq=-1, regularize_freq_on_feat=False, exp_path='./result/exp/debug\\CNN_har\\ER_LN_Oct-14-03-06-19')

 ######## exp tasks, Run 0, cls_order :[5, 2, 1, 3, 0, 4] ########
Create exp stream : 3 tasks,  classes order [5, 2, 1, 3, 0, 4] 
Input shape (L, D): (128, 9)
Training set size: 5952; Val set size: 664; Test set size: 2947
buffer has 2940 slots
ER mode: task, NCM classifier: False

--> Task 0: 2 classes in total
Epoch 1/20: Accuracy = 96.25064201335388, Loss = 0.11452019214630127
Epoch 2/20: Accuracy = 99.94863893168979, Loss = 0.002418199321255088
Epoch 3/20: Accuracy = 99.94863893168979, Loss = 0.0035355279687792063
Epoch 4/20: Accuracy = 100.0, Loss = 6.593412399524823e-05
Epoch 5/20: Accuracy = 99.69183359013869, Loss = 0.009520317427814007
Epoch 6/20: Accuracy = 100.0, Loss = 0.0003657990018837154
Epoch 7/20: Accuracy = 100.0, Loss = 2.138118816219503e-06
Epoch 8/20: Accuracy = 100.0, Loss = 2.2751401047571562e-06
Epoch 9/20: Accuracy = 100.0, Loss = 2.1530834146687994e-06
Epoch 10/20: Accuracy = 100.0, Loss = 2.0040756680828054e-06
Epoch 11/20: Accuracy = 100.0, Loss = 1.8627013105287915e-06
Epoch 12/20: Accuracy = 100.0, Loss = 1.7425065834686393e-06
Epoch 13/20: Accuracy = 100.0, Loss = 1.631830400583567e-06
Epoch 14/20: Accuracy = 100.0, Loss = 1.53671965108515e-06
Epoch 15/20: Accuracy = 100.0, Loss = 1.4540776192006888e-06
Epoch 16/20: Accuracy = 100.0, Loss = 1.4202863667378551e-06
Epoch 17/20: Accuracy = 100.0, Loss = 1.3948827017884469e-06
Epoch 18/20: Accuracy = 100.0, Loss = 1.3899317536925082e-06
Epoch 19/20: Accuracy = 100.0, Loss = 1.3898549013902084e-06
Epoch 20/20: Accuracy = 100.0, Loss = 1.3705442825084901e-06

 ======== Evaluate on valid set ========
Task 0: Accuracy == 100.0, Test CE Loss == 1.1698172102114768e-06 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 97.70114942528735, Test CE Loss == 0.1260427087545395 ;

--> Task 1: 4 classes in total
Epoch 1/20: Accuracy = 68.38777660695469, Loss = 1.2158887386322021
Epoch 2/20: Accuracy = 93.88830347734456, Loss = 0.3221152126789093
Epoch 3/20: Accuracy = 97.15489989462593, Loss = 0.17034682631492615
Epoch 4/20: Accuracy = 98.63013698630137, Loss = 0.08030834794044495
Epoch 5/20: Accuracy = 98.99894625922023, Loss = 0.0654740110039711
Epoch 6/20: Accuracy = 99.52581664910431, Loss = 0.04183293133974075
Epoch 7/20: Accuracy = 99.20969441517387, Loss = 0.03593152016401291
Epoch 8/20: Accuracy = 99.73656480505795, Loss = 0.017995262518525124
Epoch 9/20: Accuracy = 99.57850368809274, Loss = 0.02476680837571621
Epoch 10/20: Accuracy = 99.73656480505795, Loss = 0.021150073036551476
Epoch 11/20: Accuracy = 99.73656480505795, Loss = 0.016613010317087173
Epoch 12/20: Accuracy = 99.89462592202318, Loss = 0.007985479198396206
Epoch 13/20: Accuracy = 99.73656480505795, Loss = 0.010717920958995819
Epoch 14/20: Accuracy = 99.84193888303477, Loss = 0.005644213408231735
Epoch 15/20: Accuracy = 99.84193888303477, Loss = 0.00400822889059782
Epoch 16/20: Accuracy = 99.94731296101159, Loss = 0.004118301440030336
Epoch 17/20: Accuracy = 99.94731296101159, Loss = 0.0009268943686038256
Epoch 18/20: Accuracy = 100.0, Loss = 0.0003518560260999948
Epoch 19/20: Accuracy = 100.0, Loss = 0.0002371785813011229
Epoch 20/20: Accuracy = 100.0, Loss = 0.00018834775255527347

 ======== Evaluate on valid set ========
Task 0: Accuracy == 93.08755760368663, Test CE Loss == 0.13974672555923462 ;
Task 1: Accuracy == 98.11320754716981, Test CE Loss == 0.05180349200963974 ;

 ======== Evaluate on test set ========
Task 0: Accuracy == 86.31138975966563, Test CE Loss == 0.4485258460044861 ;
Task 1: Accuracy == 93.45114345114345, Test CE Loss == 0.2637406289577484 ;

--> Task 2: 6 classes in total
Epoch 1/20: Accuracy = 48.837209302325576, Loss = 2.098644733428955
Epoch 2/20: Accuracy = 90.74513526340769, Loss = 0.5158531069755554
Epoch 3/20: Accuracy = 96.53535832937827, Loss = 0.22797004878520966
Epoch 4/20: Accuracy = 98.19648789748457, Loss = 0.16264031827449799
Epoch 5/20: Accuracy = 98.81347887992406, Loss = 0.12341160327196121
Epoch 6/20: Accuracy = 99.28808732795443, Loss = 0.07034836709499359
Epoch 7/20: Accuracy = 99.14570479354533, Loss = 0.05991077795624733
Epoch 8/20: Accuracy = 99.47793070716658, Loss = 0.06066058948636055
Epoch 9/20: Accuracy = 99.6203132415757, Loss = 0.04209538549184799
Epoch 10/20: Accuracy = 99.6203132415757, Loss = 0.03336912766098976
Epoch 11/20: Accuracy = 99.81015662078785, Loss = 0.02959495782852173
Epoch 12/20: Accuracy = 99.52539155196962, Loss = 0.05760805681347847
Epoch 13/20: Accuracy = 99.76269577598481, Loss = 0.020401718094944954
Epoch 14/20: Accuracy = 99.95253915519696, Loss = 0.01017045695334673
Epoch 15/20: Accuracy = 99.95253915519696, Loss = 0.01565769501030445
Epoch 16/20: Accuracy = 100.0, Loss = 0.006924359127879143
Epoch 17/20: Accuracy = 100.0, Loss = 0.00197201082482934
Epoch 18/20: Accuracy = 100.0, Loss = 0.000900308252312243
Epoch 19/20: Accuracy = 100.0, Loss = 0.0006720259552821517
Epoch 20/20: Accuracy = 100.0, Loss = 0.0008953806245699525

 ======== Evaluate on valid set ========
Task 0: Accuracy == 97.23502304147466, Test CE Loss == 0.10970882326364517 ;
Task 1: Accuracy == 88.67924528301887, Test CE Loss == 0.4959040582180023 ;
Task 2: Accuracy == 99.14893617021276, Test CE Loss == 0.019594687968492508 ;
Accuracy matrix of all tasks:
[[100.     0.     0.  ]
 [ 93.09  98.11   0.  ]
 [ 97.24  88.68  99.15]]

 ======== Evaluate on test set ========
Task 0: Accuracy == 92.16300940438872, Test CE Loss == 0.32947036623954773 ;
Task 1: Accuracy == 84.92723492723493, Test CE Loss == 0.5740129351615906 ;
Task 2: Accuracy == 94.64980544747081, Test CE Loss == 0.1967274695634842 ;
Accuracy matrix of all tasks:
[[97.7   0.    0.  ]
 [86.31 93.45  0.  ]
 [92.16 84.93 94.65]]

 Finish Run 0, running time 1164.190503358841 sec
Valid Set:
 Avg_End_Acc [95.02] Avg_End_Fgt [6.09] Avg_Cur_Acc [99.09] Avg_Acc [[100.    95.6   95.02]] Avg_Bwtp [0.] 

Test Set:
Avg_End_Acc [90.58] Avg_End_Fgt [7.03] Avg_Cur_Acc [95.27] Avg_Acc [[97.7  89.88 90.58]] Avg_Bwtp [0.]
